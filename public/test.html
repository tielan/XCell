<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>打开评价测试页</title>
    <script
      type="text/javascript"
      src="https://cdn.bootcdn.net/ajax/libs/socket.io/2.3.0/socket.io.js"
    ></script>
  </head>

  <body>
    <br />
    <div><span>websocket 方式</span></div>
    <br />
    <div>
      <input type="button" value="暂停" onclick="sendPingJia('C02')" />
      <input type="button" value="欢迎光临" onclick="sendPingJia('C01')" />
      <input type="button" value="打开评价" onclick="sendPingJia('C06')" />
      <input type="button" value="开始截屏" onclick="sendCaptrue()" />
    </div>
    <br />
    <div><span>http 方式</span></div>
    <br />
    <div>
      <input type="button" value="打开评价" onclick="httpPingJia()" />
      <input type="button" value="开始截屏" onclick="httpStartCaptrue()" />
    </div>

    <script type="text/javascript">
      var socket = io("http://localhost:3002");
      socket.on("connect", function() {});

      function httpStartCaptrue() {
        fetch("http://localhost:3002/app/capture");
      }

      function httpPingJia() {
        fetch(
          "http://localhost:3002/app/evaluate?cmdCode=C06&openUrl=" +
            encodeURIComponent("https://www.baidu.com/")
        );
      }
      function sendCaptrue() {
        var socket = io("http://localhost:3002");
        socket.on("connect", function() {
          var msg = {
            cmdCode: "C10",
          };
          socket.emit("CMD", msg, function(msg) {
            window.timer && clearTimeout(window.timer);
            console.log(msg);
          });
        });
      }
      function sendPingJia(cmdCode) {
        var msg = {
          cmdCode: cmdCode,
          data: {
            openUrl: "http://172.16.17.96:8001/#/evaluation",
            openTime: 10,
          },
        };
        socket.emit("CMD", msg, function(msg) {
          console.log(msg);
        });
      }
    </script>
    <script type="text/javascript">
      window.jsonpCallback = function(res) {
        console.log(res);
      };
    </script>
    <script
      src="http://localhost:3002/app/evaluate?cmdCode=C06&openUrl=xxx&callback=jsonpCallback"
      type="text/javascript"
    ></script>
  </body>
</html>
